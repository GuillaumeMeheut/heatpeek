(()=>{var e={};e.id=651,e.ids=[651],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},78893:e=>{"use strict";e.exports=require("buffer")},84770:e=>{"use strict";e.exports=require("crypto")},17702:e=>{"use strict";e.exports=require("events")},32615:e=>{"use strict";e.exports=require("http")},35240:e=>{"use strict";e.exports=require("https")},98216:e=>{"use strict";e.exports=require("net")},68621:e=>{"use strict";e.exports=require("punycode")},76162:e=>{"use strict";e.exports=require("stream")},82452:e=>{"use strict";e.exports=require("tls")},17360:e=>{"use strict";e.exports=require("url")},71568:e=>{"use strict";e.exports=require("zlib")},38137:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>s.a,__next_app__:()=>h,originalPathname:()=>u,pages:()=>d,routeModule:()=>p,tree:()=>c}),r(98512),r(98502),r(50151),r(78243),r(35866);var a=r(23191),n=r(88716),i=r(37922),s=r.n(i),o=r(95231),l={};for(let e in o)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>o[e]);r.d(t,l);let c=["",{children:["[locale]",{children:["(insight)",{children:["[id]",{children:["(data)",{children:["heatmap",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,98512)),"/Users/guillaume/Documents/perso/heatpeek-project/heatpeek/src/app/[locale]/(insight)/[id]/(data)/heatmap/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(r.bind(r,98502)),"/Users/guillaume/Documents/perso/heatpeek-project/heatpeek/src/app/[locale]/(insight)/[id]/(data)/layout.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(r.bind(r,50151)),"/Users/guillaume/Documents/perso/heatpeek-project/heatpeek/src/app/[locale]/(insight)/layout.tsx"]}]},{layout:[()=>Promise.resolve().then(r.bind(r,78243)),"/Users/guillaume/Documents/perso/heatpeek-project/heatpeek/src/app/[locale]/layout.tsx"]}]},{"not-found":[()=>Promise.resolve().then(r.t.bind(r,35866,23)),"next/dist/client/components/not-found-error"]}],d=["/Users/guillaume/Documents/perso/heatpeek-project/heatpeek/src/app/[locale]/(insight)/[id]/(data)/heatmap/page.tsx"],u="/[locale]/(insight)/[id]/(data)/heatmap/page",h={require:r,loadChunk:()=>Promise.resolve()},p=new a.AppPageRouteModule({definition:{kind:n.x.APP_PAGE,page:"/[locale]/(insight)/[id]/(data)/heatmap/page",pathname:"/[locale]/[id]/heatmap",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},84909:(e,t,r)=>{let a={"2c7930f941162032ab7b590c3d01e50045da5e0f":()=>Promise.resolve().then(r.bind(r,32499)).then(e=>e.createNewVersion),"12d1b960d162fcd9e9feea23a05b842f334f050e":()=>Promise.resolve().then(r.bind(r,5559)).then(e=>e.signOut),"6a8a26413187bace2643ca46c408820ea12e2665":()=>Promise.resolve().then(r.bind(r,5559)).then(e=>e.signUp),dc2a9c5531559720941b8aaec462d0ad3ea2145e:()=>Promise.resolve().then(r.bind(r,5559)).then(e=>e.signIn)};async function n(e,...t){return(await a[e]()).apply(null,t)}e.exports={"2c7930f941162032ab7b590c3d01e50045da5e0f":n.bind(null,"2c7930f941162032ab7b590c3d01e50045da5e0f"),"12d1b960d162fcd9e9feea23a05b842f334f050e":n.bind(null,"12d1b960d162fcd9e9feea23a05b842f334f050e"),"6a8a26413187bace2643ca46c408820ea12e2665":n.bind(null,"6a8a26413187bace2643ca46c408820ea12e2665"),dc2a9c5531559720941b8aaec462d0ad3ea2145e:n.bind(null,"dc2a9c5531559720941b8aaec462d0ad3ea2145e")}},76400:(e,t,r)=>{Promise.resolve().then(r.bind(r,6304)),Promise.resolve().then(r.bind(r,87594))},12714:(e,t,r)=>{"use strict";r.d(t,{Z:()=>a});let a=(0,r(62881).Z)("eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]])},21066:(e,t,r)=>{"use strict";r.d(t,{Z:()=>a});let a=(0,r(62881).Z)("mouse-pointer-click",[["path",{d:"M14 4.1 12 6",key:"ita8i4"}],["path",{d:"m5.1 8-2.9-.8",key:"1go3kf"}],["path",{d:"m6 12-1.9 2",key:"mnht97"}],["path",{d:"M7.2 2.2 8 5.1",key:"1cfko1"}],["path",{d:"M9.037 9.69a.498.498 0 0 1 .653-.653l11 4.5a.5.5 0 0 1-.074.949l-4.349 1.041a1 1 0 0 0-.74.739l-1.04 4.35a.5.5 0 0 1-.95.074z",key:"s0h3yz"}]])},58422:e=>{"use strict";function t(e){if(!(this instanceof t))return new t(e);this._canvas=e="string"==typeof e?document.getElementById(e):e,this._ctx=e.getContext("2d"),this._width=e.width,this._height=e.height,this._max=1,this._data=[]}e.exports=t,t.prototype={defaultRadius:25,defaultGradient:{.4:"blue",.6:"cyan",.7:"lime",.8:"yellow",1:"red"},data:function(e){return this._data=e,this},max:function(e){return this._max=e,this},add:function(e){return this._data.push(e),this},clear:function(){return this._data=[],this},radius:function(e,t){t=void 0===t?15:t;var r=this._circle=this._createCanvas(),a=r.getContext("2d"),n=this._r=e+t;return r.width=r.height=2*n,a.shadowOffsetX=a.shadowOffsetY=2*n,a.shadowBlur=t,a.shadowColor="black",a.beginPath(),a.arc(-n,-n,e,0,2*Math.PI,!0),a.closePath(),a.fill(),this},resize:function(){this._width=this._canvas.width,this._height=this._canvas.height},gradient:function(e){var t=this._createCanvas(),r=t.getContext("2d"),a=r.createLinearGradient(0,0,0,256);for(var n in t.width=1,t.height=256,e)a.addColorStop(+n,e[n]);return r.fillStyle=a,r.fillRect(0,0,1,256),this._grad=r.getImageData(0,0,1,256).data,this},draw:function(e){this._circle||this.radius(this.defaultRadius),this._grad||this.gradient(this.defaultGradient);var t=this._ctx;t.clearRect(0,0,this._width,this._height);for(var r,a=0,n=this._data.length;a<n;a++)r=this._data[a],t.globalAlpha=Math.max(r[2]/this._max,void 0===e?.05:e),t.drawImage(this._circle,r[0]-this._r,r[1]-this._r);var i=t.getImageData(0,0,this._width,this._height);return this._colorize(i.data,this._grad),t.putImageData(i,0,0),this},_colorize:function(e,t){for(var r,a=0,n=e.length;a<n;a+=4)(r=4*e[a+3])&&(e[a]=t[r],e[a+1]=t[r+1],e[a+2]=t[r+2])},_createCanvas:function(){return"undefined"!=typeof document?document.createElement("canvas"):new this._canvas.constructor}}},6304:(e,t,r)=>{"use strict";r.d(t,{default:()=>eB});var a=r(10326),n=r(17577),i=r.n(n),s=r(46226);r(58422);let o={GRID_SIZE:20};var l=r(15757),c=r(38606);function d({containerDimensions:e,cumulativeViews:t,maxCumulative:r}){let n=i().useRef(null),s=i().useRef(null),[o,l]=i().useState(null);function c(a){let i=a.currentTarget.getBoundingClientRect(),o=Math.max(0,Math.min(a.clientY-i.top,e.height-1)),c=n.current?.offsetWidth||0,d=e.width/2-c/2;n.current&&(n.current.style.transform=`translate(${d}px, ${o-18<0?o+8:o-18}px)`,n.current.style.display="block"),s.current&&(s.current.style.transform=`translateY(${o}px)`,s.current.style.display="block"),l((t[Math.round(o/e.height*1e3)]||0)/r*100)}return(0,a.jsxs)("div",{className:"absolute inset-0 z-40",style:{width:e.width,height:e.height},onMouseMove:c,onMouseLeave:function(){n.current&&(n.current.style.display="none"),s.current&&(s.current.style.display="none"),l(null)},onMouseEnter:c,children:[a.jsx("div",{ref:s,style:{position:"absolute",left:0,top:0,width:"100%",height:"2px",background:"#222",zIndex:100,pointerEvents:"none",transform:"translateY(0)",display:"none"}}),a.jsx("div",{ref:n,style:{position:"absolute",left:0,top:0,background:"rgba(0,0,0,0.7)",color:"#fff",padding:"2px 8px",borderRadius:4,fontSize:12,pointerEvents:"none",zIndex:101,transform:"translate(0, 0)",display:"none"},children:null!==o?`${o.toFixed(1)}% users reached here`:""})]})}(0,l.Z)().domain([0,.25,.5,.75,1]).range(["#DDDEDE","#68F21E","#E4F21E","#F79227","#F21E1E"]).interpolate(c.ZP);var u=r(21066),h=r(12714),p=r(62881);let f=(0,p.Z)("zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]]);var g=r(78062);function m({containerDimensions:e,pageData:t,elements:r,canvasRef:i}){let s=(0,n.useRef)(null),o=(0,n.useRef)(null),l=(0,n.useRef)(null);return(0,a.jsxs)("div",{ref:s,className:"absolute inset-0 pointer-events-none z-40",style:{display:"none"},children:[a.jsx("div",{ref:l,className:"absolute border-2 border-blue-500 rounded-md pointer-events-none",style:{display:"none"}}),a.jsx("div",{ref:o,className:"absolute bg-white text-gray-800 border border-gray-300 rounded-xl shadow-xl p-4 pointer-events-none z-50 text-sm min-w-[240px] max-w-sm",style:{display:"none"},children:(0,a.jsxs)("div",{className:"space-y-2 flex flex-col gap-2 ",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[a.jsx(u.Z,{className:"h-5 w-5 text-green-500"}),a.jsx("div",{className:"font-semibold","data-clicks":!0})]}),(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[a.jsx(h.Z,{className:"h-5 w-5 text-blue-500"}),a.jsx("div",{className:"font-semibold","data-visibility":!0})]}),(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[a.jsx(f,{className:"h-5 w-5 text-red-500"}),a.jsx("div",{className:"font-semibold","data-rage-clicks":!0})]})]}),a.jsx(g.Z,{}),(0,a.jsxs)("div",{className:"flex flex-col gap-1",children:[a.jsx("p",{"data-total-clicks":!0}),a.jsx("p",{"data-conversion":!0})]})]})})]})}var x=r(41096);function v({data:e,pageData:t,dataType:r,clickType:i="aggregated",overlayOpacity:l,clickedElements:c=[]}){var u;let h=(0,n.useRef)(null),p=(0,n.useRef)(null),[f,g]=(0,n.useState)(null);u="clicks"===r||"rage_clicks"===r?e:[],(0,n.useRef)(null),(0,n.useMemo)(()=>{if(0===u.length||!t||!f||!t.width||!t.height)return[];let e=f.width/t.width,r=f.height/t.height;if("aggregated"===i)return u.map(t=>[t.grid_x*e,t.grid_y*r,2*Math.log2(t.count+1)]);{let a=null;try{if(t.dom_data){let e=JSON.parse(t.dom_data);a=new Map(e.map(e=>[e.s,e]))}}catch(e){return console.error("Error parsing DOM data:",e),[]}if(!a)return console.warn("No DOM data available for raw clicks"),[];let n=new Map;for(let e of u){let t=a.get(e.selector);if(!t)continue;let r=t.l+e.erx*t.w,i=t.t+e.ery*t.h,s=Math.round(r/o.GRID_SIZE)*o.GRID_SIZE,l=Math.round(i/o.GRID_SIZE)*o.GRID_SIZE,c=`${s},${l}`,d=n.get(c);d?d.count+=1:n.set(c,{x:r,y:i,count:1})}return Array.from(n.values()).map(({x:t,y:a,count:n})=>[t*e,a*r,2*Math.log2(n+1)])}},[u,f,t,i]);let{cumulativeViews:v,maxCumulative:w}=function(e,t,r,a){let{cumulativeViews:i,maxCumulative:s}=(0,n.useMemo)(()=>{let t=new Map;e.forEach(e=>t.set(e.scroll_depth,e.views));let r=[];for(let e=0;e<=1e3;e++){let a=0,n=Math.floor(e/10);for(let e=n;e<=100;e++)a+=t.get(e)||0;r[e]=a}let a=Math.max(...r,1);return{cumulativeViews:r,maxCumulative:a}},[e]);return{cumulativeViews:i,maxCumulative:s}}("scroll_depth"===r?e:[],0,0,0);return a.jsx("div",{ref:p,className:"relative w-full",style:{height:f?.height??"auto"},children:f&&(0,a.jsxs)("div",{className:"relative mx-auto",style:{width:f.width,height:f.height},children:[t?.screenshot_url&&a.jsx(s.default,{src:t.screenshot_url,alt:`Screenshot of ${t.label}`,className:"absolute inset-0",style:{width:f.width,height:f.height},width:f.width,height:f.height,quality:100,priority:!0}),r!==x.c.ScrollDepth&&a.jsx("div",{className:"absolute inset-0 pointer-events-none z-10",style:{background:`rgba(0,0,0,${l})`,width:f.width,height:f.height}}),r===x.c.ScrollDepth&&a.jsx(d,{containerDimensions:f,cumulativeViews:v,maxCumulative:w}),a.jsx("canvas",{ref:h,width:f.width,height:f.height,className:"absolute inset-0 z-30","aria-hidden":"true"}),r!==x.c.ScrollDepth&&c.length>0&&a.jsx(m,{containerDimensions:f,pageData:t,elements:c,canvasRef:h})]})})}var w=r(91664),y=r(82561),b=r(48051),j=r(93095),_=r(825),k=r(88957),E=r(17103),N=r(83078),R=r(9815),M=r(45226),C=r(34214),D=r(52067),S=r(6009),[P,T]=(0,j.b)("Tooltip",[E.D7]),I=(0,E.D7)(),q="TooltipProvider",z="tooltip.open",[L,A]=P(q),$=e=>{let{__scopeTooltip:t,delayDuration:r=700,skipDelayDuration:i=300,disableHoverableContent:s=!1,children:o}=e,l=n.useRef(!0),c=n.useRef(!1),d=n.useRef(0);return n.useEffect(()=>{let e=d.current;return()=>window.clearTimeout(e)},[]),(0,a.jsx)(L,{scope:t,isOpenDelayedRef:l,delayDuration:r,onOpen:n.useCallback(()=>{window.clearTimeout(d.current),l.current=!1},[]),onClose:n.useCallback(()=>{window.clearTimeout(d.current),d.current=window.setTimeout(()=>l.current=!0,i)},[i]),isPointerInTransitRef:c,onPointerInTransitChange:n.useCallback(e=>{c.current=e},[]),disableHoverableContent:s,children:o})};$.displayName=q;var O="Tooltip",[U,Z]=P(O),V=e=>{let{__scopeTooltip:t,children:r,open:i,defaultOpen:s,onOpenChange:o,disableHoverableContent:l,delayDuration:c}=e,d=A(O,e.__scopeTooltip),u=I(t),[h,p]=n.useState(null),f=(0,k.M)(),g=n.useRef(0),m=l??d.disableHoverableContent,x=c??d.delayDuration,v=n.useRef(!1),[w,y]=(0,D.T)({prop:i,defaultProp:s??!1,onChange:e=>{e?(d.onOpen(),document.dispatchEvent(new CustomEvent(z))):d.onClose(),o?.(e)},caller:O}),b=n.useMemo(()=>w?v.current?"delayed-open":"instant-open":"closed",[w]),j=n.useCallback(()=>{window.clearTimeout(g.current),g.current=0,v.current=!1,y(!0)},[y]),_=n.useCallback(()=>{window.clearTimeout(g.current),g.current=0,y(!1)},[y]),N=n.useCallback(()=>{window.clearTimeout(g.current),g.current=window.setTimeout(()=>{v.current=!0,y(!0),g.current=0},x)},[x,y]);return n.useEffect(()=>()=>{g.current&&(window.clearTimeout(g.current),g.current=0)},[]),(0,a.jsx)(E.fC,{...u,children:(0,a.jsx)(U,{scope:t,contentId:f,open:w,stateAttribute:b,trigger:h,onTriggerChange:p,onTriggerEnter:n.useCallback(()=>{d.isOpenDelayedRef.current?N():j()},[d.isOpenDelayedRef,N,j]),onTriggerLeave:n.useCallback(()=>{m?_():(window.clearTimeout(g.current),g.current=0)},[_,m]),onOpen:j,onClose:_,disableHoverableContent:m,children:r})})};V.displayName=O;var B="TooltipTrigger",F=n.forwardRef((e,t)=>{let{__scopeTooltip:r,...i}=e,s=Z(B,r),o=A(B,r),l=I(r),c=n.useRef(null),d=(0,b.e)(t,c,s.onTriggerChange),u=n.useRef(!1),h=n.useRef(!1),p=n.useCallback(()=>u.current=!1,[]);return n.useEffect(()=>()=>document.removeEventListener("pointerup",p),[p]),(0,a.jsx)(E.ee,{asChild:!0,...l,children:(0,a.jsx)(M.WV.button,{"aria-describedby":s.open?s.contentId:void 0,"data-state":s.stateAttribute,...i,ref:d,onPointerMove:(0,y.M)(e.onPointerMove,e=>{"touch"===e.pointerType||h.current||o.isPointerInTransitRef.current||(s.onTriggerEnter(),h.current=!0)}),onPointerLeave:(0,y.M)(e.onPointerLeave,()=>{s.onTriggerLeave(),h.current=!1}),onPointerDown:(0,y.M)(e.onPointerDown,()=>{s.open&&s.onClose(),u.current=!0,document.addEventListener("pointerup",p,{once:!0})}),onFocus:(0,y.M)(e.onFocus,()=>{u.current||s.onOpen()}),onBlur:(0,y.M)(e.onBlur,s.onClose),onClick:(0,y.M)(e.onClick,s.onClose)})})});F.displayName=B;var Y="TooltipPortal",[G,H]=P(Y,{forceMount:void 0}),W=e=>{let{__scopeTooltip:t,forceMount:r,children:n,container:i}=e,s=Z(Y,t);return(0,a.jsx)(G,{scope:t,forceMount:r,children:(0,a.jsx)(R.z,{present:r||s.open,children:(0,a.jsx)(N.h,{asChild:!0,container:i,children:n})})})};W.displayName=Y;var K="TooltipContent",X=n.forwardRef((e,t)=>{let r=H(K,e.__scopeTooltip),{forceMount:n=r.forceMount,side:i="top",...s}=e,o=Z(K,e.__scopeTooltip);return(0,a.jsx)(R.z,{present:n||o.open,children:o.disableHoverableContent?(0,a.jsx)(er,{side:i,...s,ref:t}):(0,a.jsx)(Q,{side:i,...s,ref:t})})}),Q=n.forwardRef((e,t)=>{let r=Z(K,e.__scopeTooltip),i=A(K,e.__scopeTooltip),s=n.useRef(null),o=(0,b.e)(t,s),[l,c]=n.useState(null),{trigger:d,onClose:u}=r,h=s.current,{onPointerInTransitChange:p}=i,f=n.useCallback(()=>{c(null),p(!1)},[p]),g=n.useCallback((e,t)=>{let r=e.currentTarget,a={x:e.clientX,y:e.clientY},n=function(e,t){let r=Math.abs(t.top-e.y),a=Math.abs(t.bottom-e.y),n=Math.abs(t.right-e.x),i=Math.abs(t.left-e.x);switch(Math.min(r,a,n,i)){case i:return"left";case n:return"right";case r:return"top";case a:return"bottom";default:throw Error("unreachable")}}(a,r.getBoundingClientRect());c(function(e){let t=e.slice();return t.sort((e,t)=>e.x<t.x?-1:e.x>t.x?1:e.y<t.y?-1:e.y>t.y?1:0),function(e){if(e.length<=1)return e.slice();let t=[];for(let r=0;r<e.length;r++){let a=e[r];for(;t.length>=2;){let e=t[t.length-1],r=t[t.length-2];if((e.x-r.x)*(a.y-r.y)>=(e.y-r.y)*(a.x-r.x))t.pop();else break}t.push(a)}t.pop();let r=[];for(let t=e.length-1;t>=0;t--){let a=e[t];for(;r.length>=2;){let e=r[r.length-1],t=r[r.length-2];if((e.x-t.x)*(a.y-t.y)>=(e.y-t.y)*(a.x-t.x))r.pop();else break}r.push(a)}return(r.pop(),1===t.length&&1===r.length&&t[0].x===r[0].x&&t[0].y===r[0].y)?t:t.concat(r)}(t)}([...function(e,t,r=5){let a=[];switch(t){case"top":a.push({x:e.x-r,y:e.y+r},{x:e.x+r,y:e.y+r});break;case"bottom":a.push({x:e.x-r,y:e.y-r},{x:e.x+r,y:e.y-r});break;case"left":a.push({x:e.x+r,y:e.y-r},{x:e.x+r,y:e.y+r});break;case"right":a.push({x:e.x-r,y:e.y-r},{x:e.x-r,y:e.y+r})}return a}(a,n),...function(e){let{top:t,right:r,bottom:a,left:n}=e;return[{x:n,y:t},{x:r,y:t},{x:r,y:a},{x:n,y:a}]}(t.getBoundingClientRect())])),p(!0)},[p]);return n.useEffect(()=>()=>f(),[f]),n.useEffect(()=>{if(d&&h){let e=e=>g(e,h),t=e=>g(e,d);return d.addEventListener("pointerleave",e),h.addEventListener("pointerleave",t),()=>{d.removeEventListener("pointerleave",e),h.removeEventListener("pointerleave",t)}}},[d,h,g,f]),n.useEffect(()=>{if(l){let e=e=>{let t=e.target,r={x:e.clientX,y:e.clientY},a=d?.contains(t)||h?.contains(t),n=!function(e,t){let{x:r,y:a}=e,n=!1;for(let e=0,i=t.length-1;e<t.length;i=e++){let s=t[e],o=t[i],l=s.x,c=s.y,d=o.x,u=o.y;c>a!=u>a&&r<(d-l)*(a-c)/(u-c)+l&&(n=!n)}return n}(r,l);a?f():n&&(f(),u())};return document.addEventListener("pointermove",e),()=>document.removeEventListener("pointermove",e)}},[d,h,l,u,f]),(0,a.jsx)(er,{...e,ref:o})}),[J,ee]=P(O,{isInside:!1}),et=(0,C.sA)("TooltipContent"),er=n.forwardRef((e,t)=>{let{__scopeTooltip:r,children:i,"aria-label":s,onEscapeKeyDown:o,onPointerDownOutside:l,...c}=e,d=Z(K,r),u=I(r),{onClose:h}=d;return n.useEffect(()=>(document.addEventListener(z,h),()=>document.removeEventListener(z,h)),[h]),n.useEffect(()=>{if(d.trigger){let e=e=>{let t=e.target;t?.contains(d.trigger)&&h()};return window.addEventListener("scroll",e,{capture:!0}),()=>window.removeEventListener("scroll",e,{capture:!0})}},[d.trigger,h]),(0,a.jsx)(_.XB,{asChild:!0,disableOutsidePointerEvents:!1,onEscapeKeyDown:o,onPointerDownOutside:l,onFocusOutside:e=>e.preventDefault(),onDismiss:h,children:(0,a.jsxs)(E.VY,{"data-state":d.stateAttribute,...u,...c,ref:t,style:{...c.style,"--radix-tooltip-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-tooltip-content-available-width":"var(--radix-popper-available-width)","--radix-tooltip-content-available-height":"var(--radix-popper-available-height)","--radix-tooltip-trigger-width":"var(--radix-popper-anchor-width)","--radix-tooltip-trigger-height":"var(--radix-popper-anchor-height)"},children:[(0,a.jsx)(et,{children:i}),(0,a.jsx)(J,{scope:r,isInside:!0,children:(0,a.jsx)(S.fC,{id:d.contentId,role:"tooltip",children:s||i})})]})})});X.displayName=K;var ea="TooltipArrow";n.forwardRef((e,t)=>{let{__scopeTooltip:r,...n}=e,i=I(r);return ee(ea,r).isInside?null:(0,a.jsx)(E.Eh,{...i,...n,ref:t})}).displayName=ea;var en=r(51223);let ei=n.forwardRef(({className:e,sideOffset:t=4,...r},n)=>a.jsx(W,{children:a.jsx(X,{ref:n,sideOffset:t,className:(0,en.cn)("z-50 overflow-hidden rounded-md bg-primary px-3 py-1.5 text-xs text-primary-foreground animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-tooltip-content-transform-origin]",e),...r})}));ei.displayName=X.displayName;let es=(0,p.Z)("mouse",[["rect",{x:"5",y:"2",width:"14",height:"20",rx:"7",key:"11ol66"}],["path",{d:"M12 6v4",key:"16clxf"}]]);var eo=r(37125),el=r(17124),ec=r(53405),ed=r(2566),eu=r(70545),eh=["PageUp","PageDown"],ep=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],ef={"from-left":["Home","PageDown","ArrowDown","ArrowLeft"],"from-right":["Home","PageDown","ArrowDown","ArrowRight"],"from-bottom":["Home","PageDown","ArrowDown","ArrowLeft"],"from-top":["Home","PageDown","ArrowUp","ArrowLeft"]},eg="Slider",[em,ex,ev]=(0,eu.B)(eg),[ew,ey]=(0,j.b)(eg,[ev]),[eb,ej]=ew(eg),e_=n.forwardRef((e,t)=>{let{name:r,min:i=0,max:s=100,step:o=1,orientation:l="horizontal",disabled:c=!1,minStepsBetweenThumbs:d=0,defaultValue:u=[i],value:h,onValueChange:p=()=>{},onValueCommit:f=()=>{},inverted:g=!1,form:m,...x}=e,v=n.useRef(new Set),w=n.useRef(0),b="horizontal"===l?eN:eR,[j=[],_]=(0,D.T)({prop:h,defaultProp:u,onChange:e=>{let t=[...v.current];t[w.current]?.focus(),p(e)}}),k=n.useRef(j);function E(e,t,{commit:r}={commit:!1}){let a=(String(o).split(".")[1]||"").length,n=function(e,t){let r=Math.pow(10,t);return Math.round(e*r)/r}(Math.round((e-i)/o)*o+i,a),l=(0,eo.u)(n,[i,s]);_((e=[])=>{var a,n;let i=function(e=[],t,r){let a=[...e];return a[r]=t,a.sort((e,t)=>e-t)}(e,l,t);if(a=i,!(!((n=d*o)>0)||Math.min(...a.slice(0,-1).map((e,t)=>a[t+1]-e))>=n))return e;{w.current=i.indexOf(l);let t=String(i)!==String(e);return t&&r&&f(i),t?i:e}})}return(0,a.jsx)(eb,{scope:e.__scopeSlider,name:r,disabled:c,min:i,max:s,valueIndexToChangeRef:w,thumbs:v.current,values:j,orientation:l,form:m,children:(0,a.jsx)(em.Provider,{scope:e.__scopeSlider,children:(0,a.jsx)(em.Slot,{scope:e.__scopeSlider,children:(0,a.jsx)(b,{"aria-disabled":c,"data-disabled":c?"":void 0,...x,ref:t,onPointerDown:(0,y.M)(x.onPointerDown,()=>{c||(k.current=j)}),min:i,max:s,inverted:g,onSlideStart:c?void 0:function(e){let t=function(e,t){if(1===e.length)return 0;let r=e.map(e=>Math.abs(e-t));return r.indexOf(Math.min(...r))}(j,e);E(e,t)},onSlideMove:c?void 0:function(e){E(e,w.current)},onSlideEnd:c?void 0:function(){let e=k.current[w.current];j[w.current]!==e&&f(j)},onHomeKeyDown:()=>!c&&E(i,0,{commit:!0}),onEndKeyDown:()=>!c&&E(s,j.length-1,{commit:!0}),onStepKeyDown:({event:e,direction:t})=>{if(!c){let r=eh.includes(e.key)||e.shiftKey&&ep.includes(e.key),a=w.current;E(j[a]+o*(r?10:1)*t,a,{commit:!0})}}})})})})});e_.displayName=eg;var[ek,eE]=ew(eg,{startEdge:"left",endEdge:"right",size:"width",direction:1}),eN=n.forwardRef((e,t)=>{let{min:r,max:i,dir:s,inverted:o,onSlideStart:l,onSlideMove:c,onSlideEnd:d,onStepKeyDown:u,...h}=e,[p,f]=n.useState(null),g=(0,b.e)(t,e=>f(e)),m=n.useRef(void 0),x=(0,el.gm)(s),v="ltr"===x,w=v&&!o||!v&&o;function y(e){let t=m.current||p.getBoundingClientRect(),a=eA([0,t.width],w?[r,i]:[i,r]);return m.current=t,a(e-t.left)}return(0,a.jsx)(ek,{scope:e.__scopeSlider,startEdge:w?"left":"right",endEdge:w?"right":"left",direction:w?1:-1,size:"width",children:(0,a.jsx)(eM,{dir:x,"data-orientation":"horizontal",...h,ref:g,style:{...h.style,"--radix-slider-thumb-transform":"translateX(-50%)"},onSlideStart:e=>{let t=y(e.clientX);l?.(t)},onSlideMove:e=>{let t=y(e.clientX);c?.(t)},onSlideEnd:()=>{m.current=void 0,d?.()},onStepKeyDown:e=>{let t=ef[w?"from-left":"from-right"].includes(e.key);u?.({event:e,direction:t?-1:1})}})})}),eR=n.forwardRef((e,t)=>{let{min:r,max:i,inverted:s,onSlideStart:o,onSlideMove:l,onSlideEnd:c,onStepKeyDown:d,...u}=e,h=n.useRef(null),p=(0,b.e)(t,h),f=n.useRef(void 0),g=!s;function m(e){let t=f.current||h.current.getBoundingClientRect(),a=eA([0,t.height],g?[i,r]:[r,i]);return f.current=t,a(e-t.top)}return(0,a.jsx)(ek,{scope:e.__scopeSlider,startEdge:g?"bottom":"top",endEdge:g?"top":"bottom",size:"height",direction:g?1:-1,children:(0,a.jsx)(eM,{"data-orientation":"vertical",...u,ref:p,style:{...u.style,"--radix-slider-thumb-transform":"translateY(50%)"},onSlideStart:e=>{let t=m(e.clientY);o?.(t)},onSlideMove:e=>{let t=m(e.clientY);l?.(t)},onSlideEnd:()=>{f.current=void 0,c?.()},onStepKeyDown:e=>{let t=ef[g?"from-bottom":"from-top"].includes(e.key);d?.({event:e,direction:t?-1:1})}})})}),eM=n.forwardRef((e,t)=>{let{__scopeSlider:r,onSlideStart:n,onSlideMove:i,onSlideEnd:s,onHomeKeyDown:o,onEndKeyDown:l,onStepKeyDown:c,...d}=e,u=ej(eg,r);return(0,a.jsx)(M.WV.span,{...d,ref:t,onKeyDown:(0,y.M)(e.onKeyDown,e=>{"Home"===e.key?(o(e),e.preventDefault()):"End"===e.key?(l(e),e.preventDefault()):eh.concat(ep).includes(e.key)&&(c(e),e.preventDefault())}),onPointerDown:(0,y.M)(e.onPointerDown,e=>{let t=e.target;t.setPointerCapture(e.pointerId),e.preventDefault(),u.thumbs.has(t)?t.focus():n(e)}),onPointerMove:(0,y.M)(e.onPointerMove,e=>{e.target.hasPointerCapture(e.pointerId)&&i(e)}),onPointerUp:(0,y.M)(e.onPointerUp,e=>{let t=e.target;t.hasPointerCapture(e.pointerId)&&(t.releasePointerCapture(e.pointerId),s(e))})})}),eC="SliderTrack",eD=n.forwardRef((e,t)=>{let{__scopeSlider:r,...n}=e,i=ej(eC,r);return(0,a.jsx)(M.WV.span,{"data-disabled":i.disabled?"":void 0,"data-orientation":i.orientation,...n,ref:t})});eD.displayName=eC;var eS="SliderRange",eP=n.forwardRef((e,t)=>{let{__scopeSlider:r,...i}=e,s=ej(eS,r),o=eE(eS,r),l=n.useRef(null),c=(0,b.e)(t,l),d=s.values.length,u=s.values.map(e=>eL(e,s.min,s.max));return(0,a.jsx)(M.WV.span,{"data-orientation":s.orientation,"data-disabled":s.disabled?"":void 0,...i,ref:c,style:{...e.style,[o.startEdge]:(d>1?Math.min(...u):0)+"%",[o.endEdge]:100-Math.max(...u)+"%"}})});eP.displayName=eS;var eT="SliderThumb",eI=n.forwardRef((e,t)=>{let r=ex(e.__scopeSlider),[i,s]=n.useState(null),o=(0,b.e)(t,e=>s(e)),l=n.useMemo(()=>i?r().findIndex(e=>e.ref.current===i):-1,[r,i]);return(0,a.jsx)(eq,{...e,ref:o,index:l})}),eq=n.forwardRef((e,t)=>{let{__scopeSlider:r,index:i,name:s,...o}=e,l=ej(eT,r),c=eE(eT,r),[d,u]=n.useState(null),h=(0,b.e)(t,e=>u(e)),p=!d||l.form||!!d.closest("form"),f=(0,ed.t)(d),g=l.values[i],m=void 0===g?0:eL(g,l.min,l.max),x=function(e,t){return t>2?`Value ${e+1} of ${t}`:2===t?["Minimum","Maximum"][e]:void 0}(i,l.values.length),v=f?.[c.size],w=v?function(e,t,r){let a=e/2,n=eA([0,50],[0,a]);return(a-n(t)*r)*r}(v,m,c.direction):0;return n.useEffect(()=>{if(d)return l.thumbs.add(d),()=>{l.thumbs.delete(d)}},[d,l.thumbs]),(0,a.jsxs)("span",{style:{transform:"var(--radix-slider-thumb-transform)",position:"absolute",[c.startEdge]:`calc(${m}% + ${w}px)`},children:[(0,a.jsx)(em.ItemSlot,{scope:e.__scopeSlider,children:(0,a.jsx)(M.WV.span,{role:"slider","aria-label":e["aria-label"]||x,"aria-valuemin":l.min,"aria-valuenow":g,"aria-valuemax":l.max,"aria-orientation":l.orientation,"data-orientation":l.orientation,"data-disabled":l.disabled?"":void 0,tabIndex:l.disabled?void 0:0,...o,ref:h,style:void 0===g?{display:"none"}:e.style,onFocus:(0,y.M)(e.onFocus,()=>{l.valueIndexToChangeRef.current=i})})}),p&&(0,a.jsx)(ez,{name:s??(l.name?l.name+(l.values.length>1?"[]":""):void 0),form:l.form,value:g},i)]})});eI.displayName=eT;var ez=n.forwardRef(({__scopeSlider:e,value:t,...r},i)=>{let s=n.useRef(null),o=(0,b.e)(s,i),l=(0,ec.D)(t);return n.useEffect(()=>{let e=s.current;if(!e)return;let r=Object.getOwnPropertyDescriptor(window.HTMLInputElement.prototype,"value").set;if(l!==t&&r){let a=new Event("input",{bubbles:!0});r.call(e,t),e.dispatchEvent(a)}},[l,t]),(0,a.jsx)(M.WV.input,{style:{display:"none"},...r,ref:o,defaultValue:t})});function eL(e,t,r){return(0,eo.u)(100/(r-t)*(e-t),[0,100])}function eA(e,t){return r=>{if(e[0]===e[1]||t[0]===t[1])return t[0];let a=(t[1]-t[0])/(e[1]-e[0]);return t[0]+a*(r-e[0])}}ez.displayName="RadioBubbleInput";let e$=n.forwardRef(({className:e,...t},r)=>(0,a.jsxs)(e_,{ref:r,className:(0,en.cn)("relative flex w-full touch-none select-none items-center",e),...t,children:[a.jsx(eD,{className:"relative h-1.5 w-full grow overflow-hidden rounded-full bg-secondary/20",children:a.jsx(eP,{className:"absolute h-full bg-secondary"})}),a.jsx(eI,{className:"block h-4 w-4 rounded-full border border-secondary/50 bg-background shadow transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50"})]}));e$.displayName=e_.displayName;var eO=r(71475),eU=r(35047);function eZ({icon:e,tooltip:t,onClick:r,active:n}){return(0,a.jsxs)(V,{children:[a.jsx(F,{asChild:!0,children:a.jsx(w.z,{size:"icon",variant:"secondary",className:`${n?"":"bg-transparent color-white border-white border-[1px]"}`,onClick:r,children:a.jsx(e,{className:"h-4 w-4"})})}),a.jsx(ei,{className:"bg-secondary",children:a.jsx("p",{children:t})})]})}function eV({opacity:e,onOpacityChange:t,activeType:r}){let i=(0,eO.QT)(),s=(0,eU.useSearchParams)(),o=(0,eU.useRouter)(),l=e=>{let t=new URLSearchParams(s.toString());t.set("type",e),o.replace(`?${t.toString()}`)},[c,d]=function(e,t,r){let[a,i]=(0,n.useState)(e);return[a,i]}(e,0,e=>t?.(e));return a.jsx($,{children:(0,a.jsxs)("div",{className:"fixed left-1/2 -translate-x-1/2 bottom-4 flex items-center gap-4 px-4 py-3 bg-black/90 backdrop-blur-sm rounded-full shadow-lg z-50 border border-white/30",children:[(0,a.jsxs)("div",{className:"flex gap-2",children:[a.jsx(eZ,{icon:u.Z,tooltip:i("optionsBar.clickPatterns"),onClick:()=>l(x.c.Clicks),active:r===x.c.Clicks}),a.jsx(eZ,{icon:f,tooltip:i("optionsBar.rageClicks"),onClick:()=>l(x.c.RageClicks),active:r===x.c.RageClicks}),a.jsx(eZ,{icon:es,tooltip:i("optionsBar.scroll"),onClick:()=>l(x.c.ScrollDepth),active:r===x.c.ScrollDepth})]}),a.jsx(g.Z,{orientation:"vertical",className:"h-6"}),(0,a.jsxs)("div",{className:"flex items-center gap-2 w-32",children:[(0,a.jsxs)(V,{children:[a.jsx(F,{asChild:!0,children:a.jsx(h.Z,{className:"h-4 w-4 text-secondary"})}),a.jsx(ei,{children:a.jsx("p",{children:i("optionsBar.opacity")})})]}),a.jsx(e$,{value:[c],onValueChange:e=>d(e[0]),max:100,step:1,className:"w-full"})]})]})})}function eB({data:e,type:t,pageData:r,clickType:i="aggregated",clickedElements:s}){let[o,l]=(0,n.useState)(40);return(0,a.jsxs)("div",{className:"relative",children:[a.jsx(v,{data:e,pageData:r,dataType:t,clickType:i,overlayOpacity:o/100,clickedElements:s}),a.jsx(eV,{opacity:o,onOpacityChange:l,activeType:t})]})}},87594:(e,t,r)=>{"use strict";r.d(t,{default:()=>u});var a=r(10326),n=r(91664);let i=(0,r(62881).Z)("refresh-ccw",[["path",{d:"M21 12a9 9 0 0 0-9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"14sxne"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M3 12a9 9 0 0 0 9 9 9.75 9.75 0 0 0 6.74-2.74L21 16",key:"1hlbsb"}],["path",{d:"M16 16h5v5",key:"ccwih5"}]]);var s=r(77506),o=r(17577);r(15424);var l=(0,r(46242).$)("2c7930f941162032ab7b590c3d01e50045da5e0f"),c=r(55296),d=r(71475);function u({urlId:e,device:t}){let[r,u]=(0,o.useTransition)(),h=(0,d.QT)();return(0,a.jsxs)(c.aR,{children:[a.jsx(c.vW,{asChild:!0,children:(0,a.jsxs)(n.z,{className:"mb-4",children:[a.jsx(i,{className:"h-4 w-4"}),h("versioning.createNewVersionButton")]})}),(0,a.jsxs)(c._T,{children:[(0,a.jsxs)(c.fY,{children:[a.jsx(c.f$,{children:h("versioning.confirmTitle")}),a.jsx(c.yT,{children:h("versioning.confirmDescription")})]}),(0,a.jsxs)(c.xo,{children:[a.jsx(c.le,{children:h("global.cancel")}),a.jsx(c.OL,{variant:"default",onClick:()=>{u(async()=>{try{await l(e,t,window.location.href)}catch(e){console.error("Failed to create new version:",e)}})},disabled:r,children:r?a.jsx(s.Z,{className:"w-4 h-4 animate-spin"}):h("versioning.createNewVersionAction")})]})]})]})}},55296:(e,t,r)=>{"use strict";r.d(t,{OL:()=>x,_T:()=>h,aR:()=>l,f$:()=>g,fY:()=>p,le:()=>v,vW:()=>c,xo:()=>f,yT:()=>m});var a=r(10326),n=r(17577),i=r(80440),s=r(51223),o=r(91664);let l=i.fC,c=i.xz,d=i.h_,u=n.forwardRef(({className:e,...t},r)=>a.jsx(i.aV,{className:(0,s.cn)("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),...t,ref:r}));u.displayName=i.aV.displayName;let h=n.forwardRef(({className:e,...t},r)=>(0,a.jsxs)(d,{children:[a.jsx(u,{}),a.jsx(i.VY,{ref:r,className:(0,s.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",e),...t})]}));h.displayName=i.VY.displayName;let p=({className:e,...t})=>a.jsx("div",{className:(0,s.cn)("flex flex-col space-y-2 text-center sm:text-left",e),...t});p.displayName="AlertDialogHeader";let f=({className:e,...t})=>a.jsx("div",{className:(0,s.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",e),...t});f.displayName="AlertDialogFooter";let g=n.forwardRef(({className:e,...t},r)=>a.jsx(i.Dx,{ref:r,className:(0,s.cn)("text-lg font-semibold",e),...t}));g.displayName=i.Dx.displayName;let m=n.forwardRef(({className:e,...t},r)=>a.jsx(i.dk,{ref:r,className:(0,s.cn)("text-sm text-muted-foreground",e),...t}));m.displayName=i.dk.displayName;let x=n.forwardRef(({className:e,variant:t,...r},n)=>a.jsx(i.aU,{ref:n,className:(0,s.cn)((0,o.d)({variant:t}),e),...r}));x.displayName=i.aU.displayName;let v=n.forwardRef(({className:e,...t},r)=>a.jsx(i.$j,{ref:r,className:(0,s.cn)((0,o.d)({variant:"outline"}),"mt-2 sm:mt-0",e),...t}));v.displayName=i.$j.displayName},32499:(e,t,r)=>{"use strict";r.r(t),r.d(t,{createNewVersion:()=>c});var a=r(27745);r(26461);var n=r(49025),i=r(15583),s=r(71870),o=r(43811),l=r(74739);async function c(e,t,r){if(!e||!t)throw Error("Missing required parameters: urlId and device are required");let a=await (0,s.e)(),{data:c,error:d}=await a.from("snapshots").update({is_outdated:!0}).eq("url_id",e).eq("device",t).eq("is_outdated",!1).select("label, urls!inner(path, tracking_id)").single();if(d)throw console.error("Snapshot update error:",d),Error(`Failed to update current snapshot: ${d.message}`);if(!c)throw Error("No active snapshot found to update");let u={desktop:"update_snap_desktop",tablet:"update_snap_tablet",mobile:"update_snap_mobile"}[t];if(!u)throw Error("Invalid device type");await (0,i.SQ)(a,e,{[u]:!0}),await (0,i.eW)(a,{url_id:e,device:t,label:c.label}),await (0,n.Q)(c.urls.tracking_id,c.urls.path),await (0,n.G)(c.urls.tracking_id,c.urls.path,t),(0,l.redirect)((0,o.zs)(r,"Success!","New version created."))}(0,r(85723).h)([c]),(0,a.j)("2c7930f941162032ab7b590c3d01e50045da5e0f",c)},98512:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>g});var a=r(19510),n=r(538),i=r(65655),s=r(58585),o=r(93804),l=r(71159);let c=(0,r(27162).Z)("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);var d=r(68570);let u=(0,d.createProxy)(String.raw`/Users/guillaume/Documents/perso/heatpeek-project/heatpeek/src/app/[locale]/(insight)/[id]/(data)/heatmap/VersioningButton.tsx#default`),h=(0,d.createProxy)(String.raw`/Users/guillaume/Documents/perso/heatpeek-project/heatpeek/src/app/[locale]/(insight)/[id]/(data)/heatmap/HeatmapWithOptions.tsx#default`);var p=r(6351),f=r(98666);async function g({params:e,searchParams:t}){let r=await (0,i.e)(),{user:d}=await (0,n.PR)(r);d||(0,s.redirect)("/signin");let{id:g}=await e,m=t.url,x=t.device,v=t.type;if(v&&(v===f.c.Clicks||v===f.c.RageClicks||v===f.c.ScrollDepth)||(v=f.c.Clicks),!m||"all"===m||!x||x!==f.S.Desktop&&x!==f.S.Mobile&&x!==f.S.Tablet)return a.jsx("div",{children:"Query params are not valid"});let w=await (0,n.vM)(r,g,m,x);if(!w)return a.jsx("div",{children:"No snapshot found"});if(null===w.screenshot_url)return a.jsx("div",{children:"The data is still being processed"});let y=await (0,n.KM)(r,g);if(!y)return a.jsx("div",{children:"Error"});let b=null,j=await (0,p.Vh)({trackingId:y.tracking_id,path:m,snapshotId:w.id,device:x,browser:"chrome"}),_=await (0,p.Bc)({trackingId:y.tracking_id,path:m,snapshotId:w.id,device:x,browser:"chrome"}),k=await (0,p.u_)({trackingId:y.tracking_id,path:m,snapshotId:w.id,device:x,browser:"chrome"});switch(v){case f.c.Clicks:b=j;break;case f.c.RageClicks:b=_;break;case f.c.ScrollDepth:b=k;break;default:b=j}let E=function(e,t,r,a){if(!e)return[];let n=new Map,i=new Map;for(let e of t)if("selector"in e){let t=e.selector;n.set(t,(n.get(t)||0)+1)}for(let e of r)if("selector"in e){let t=e.selector;i.set(t,(i.get(t)||0)+1)}let s=a.reduce((e,t)=>e+t.views,0),o=Array.from(n.values()).reduce((e,t)=>e+t,0)+Array.from(i.values()).reduce((e,t)=>e+t,0),l=JSON.parse(e);return l.map(e=>{let t=n.get(e.s)||0,r=i.get(e.s)||0,c=Math.max(...l.map(e=>e.t+e.h)),d=a.filter(t=>t.scroll_depth/100*c>=e.t).reduce((e,t)=>e+t.views,0),u=t+r;return{s:e.s,l:e.l,t:e.t,w:e.w,h:e.h,clicks:t,rageClicks:r,visibilityPercentage:Math.round(100*(s>0?d/s*100:0))/100,clickConversionRate:Math.round(100*(d>0?u/d*100:0))/100,percentageOfTotalClicks:Math.round(100*(o>0?u/o*100:0))/100}}).filter(e=>e.clicks>0||e.rageClicks>0)}(w.dom_data,j,_,k);return a.jsx("div",{className:"flex",children:(0,a.jsxs)("div",{className:"flex-1 p-4",children:[a.jsx(u,{urlId:w.url_id,device:x}),a.jsx(l.Suspense,{fallback:a.jsx("div",{className:"flex justify-center items-center h-screen",children:a.jsx(c,{className:"h-10 w-10 animate-spin"})}),children:a.jsx(o.Zb,{className:"border-primary/20",children:a.jsx("div",{className:"container mx-auto p-4 relative",children:a.jsx("div",{className:"w-full",children:a.jsx("div",{className:"relative min-w-full",children:a.jsx(h,{data:b,type:v,pageData:w,clickType:"raw",clickedElements:E})})})})})})]})})}},49025:(e,t,r)=>{"use strict";r.d(t,{G:()=>n,Q:()=>a});let a=async(e,t)=>{await fetch("http://localhost:8787/api/project/config/purge",{method:"DELETE",headers:{"x-api-key":process.env.INTERNAL_API_KEY,"Content-Type":"application/json"},body:JSON.stringify({id:e,p:t})})},n=async(e,t,r)=>{await fetch("http://localhost:8787/api/project/snapshot/purge",{method:"DELETE",headers:{"x-api-key":process.env.INTERNAL_API_KEY,"Content-Type":"application/json"},body:JSON.stringify({id:e,p:t,d:r})})}},15583:(e,t,r)=>{"use strict";r.d(t,{B:()=>i,B2:()=>d,PR:()=>n,SQ:()=>h,Xv:()=>s,eW:()=>l,sA:()=>u,th:()=>c,ty:()=>o});var a=r(49739);let n=(0,a.cache)(async e=>{let{data:{user:t},error:r}=await e.auth.getUser();return{user:t,error:r}}),i=(0,a.cache)(async(e,t)=>{let{data:r,error:a}=await e.from("projects").insert(t).select("id").single();if(a){if(console.log("Error adding project:",a),"23505"===a.code)throw Error("Project with this base URL already exists");throw Error("Error adding project")}return r.id}),s=(0,a.cache)(async(e,t)=>{let{error:r}=await e.from("project_config").insert(t);if(r)throw console.log("Error adding page config:",r),Error("Error adding page config")}),o=(0,a.cache)(async(e,t,r)=>{let{error:a}=await e.from("projects").update(r).eq("id",t);if(a)throw console.error("Error updating project:",a),Error("Failed to update project")});(0,a.cache)(async(e,t)=>{let{data:r,error:a}=await e.from("urls").insert(t).select("id").single();if(a){if(console.log("Error adding url:",a),"23505"===a.code)throw Error("Url already exists");throw Error("Error adding url")}return r.id}),(0,a.cache)(async(e,t)=>{let{error:r}=await e.from("page_config").insert(t);if(r)throw console.log("Error adding page config:",r),Error("Error adding page config")}),(0,a.cache)(async(e,t)=>{let{data:r,error:a}=await e.from("urls").select("id, path, label").eq("project_id",t);return a?(console.log("Error fetching urls:",a),null):r}),(0,a.cache)(async(e,t)=>{let{data:r,error:a}=await e.from("urls").select(`
        id,
        path,
        label,
        views,
        clicks,
        tracking_id,
        page_config (
          id,
          is_active
        )
      `).eq("project_id",t);return a?(console.log("Error fetching urls:",a),null):r});let l=(0,a.cache)(async(e,t)=>{let{error:r}=await e.from("snapshots").insert(t);if(r)throw console.error("Error inserting snapshot:",r),Error("Error inserting snapshot")});(0,a.cache)(async(e,t)=>{let{error:r}=await e.from("snapshots").insert(t);if(r)throw console.error("Error inserting snapshot:",r),Error("Error inserting snapshot")}),(0,a.cache)(async(e,t,r,a)=>{let{error:n}=await e.from("snapshots").update(a).eq("url_id",t).eq("is_outdated",!1).eq("device",r);return n?(console.log("Error updating snapshot:",n),null):"success"}),(0,a.cache)(async(e,t,r,a)=>{let{data:n,error:i}=await e.from("snapshots").select(`id, 
       label, 
       screenshot_url, 
       width, 
       height, 
       url_id,
       dom_data,
       urls!inner (
         path, 
         project_id
       )`).eq("urls.project_id",t).eq("urls.path",r).eq("device",a).eq("is_outdated",!1).single();return i?(console.log("Error fetching snapshot:",i),null):n}),(0,a.cache)(async(e,t,r,a)=>{let{data:n,error:i}=await e.from("snapshots").select(`
        id,
        dom_data,
        urls!inner (
          tracking_id,
          path
        )
      `).eq("urls.tracking_id",t).eq("urls.path",r).eq("device",a).eq("is_outdated",!1).single();return i?(console.log("Error fetching snapshot id:",i),null):n}),(0,a.cache)(async(e,t)=>{let r=`${t.urlId}/${t.layoutHash}.png`,{error:a}=await e.storage.from("screenshots").upload(r,t.buffer,{contentType:"image/png",upsert:!0});if(a)return console.error("Error uploading screenshot:",a),null;let{data:n}=e.storage.from("screenshots").getPublicUrl(r);return n.publicUrl}),(0,a.cache)(async(e,t,r,a)=>{let{data:n,error:i}=await e.from("snapshots").select(`should_update, url_id,
        urls!inner(
          tracking_id
        )
      `).eq("urls.tracking_id",t).eq("urls.path",r).eq("device",a).eq("is_outdated",!1).single();return i?(console.log("Error fetching snapshot id:",i),null):n}),(0,a.cache)(async(e,t)=>{let{data:r,error:a}=await e.from("projects").select("tracking_id, base_url").eq("id",t).single();return a?(console.log("Error getting tracking ID and base URL:",a),null):r}),(0,a.cache)(async(e,t)=>{let{data:r,error:a}=await e.from("projects").select("tracking_id").eq("id",t).single();return a?(console.log("Error getting tracking ID:",a),null):r.tracking_id}),(0,a.cache)(async(e,t)=>{let{data:r,error:a}=await e.from("project_config").select("id").eq("project_id",t).single();return a?(console.log("Error getting project config ID:",a),null):r.id}),(0,a.cache)(async(e,t)=>{let{data:r,error:a}=await e.from("projects").select("id, label, base_url, type, created_at").eq("user_id",t);return a?(console.log("Error fetching projects:",a),null):r});let c=(0,a.cache)(async(e,t)=>{let{error:r}=await e.from("projects").delete().eq("id",t);if(r)throw console.error("Error deleting project:",r),Error("Failed to delete project")}),d=(0,a.cache)(async(e,t)=>{let{error:r}=await e.from("urls").delete().eq("id",t);if(r)throw console.error("Error deleting url:",r),Error("Failed to delete url.")}),u=(0,a.cache)(async(e,t,r)=>{let{error:a}=await e.from("urls").update(r).eq("id",t);if(a)throw console.error("Error updating url:",a),Error("Failed to update url")}),h=(0,a.cache)(async(e,t,r)=>{let{error:a}=await e.from("page_config").update(r).eq("url_id",t);if(a)throw console.error("Error updating page config:",a),Error("Failed to update page config")});(0,a.cache)(async(e,t)=>{let{data:r,error:a}=await e.from("user_profiles").select("stripe_customer_id, current_plan, subscription_status").eq("id",t).single();if(a)throw console.error("Error getting customer ID:",a),Error("Failed to get customer ID");return r})},43811:(e,t,r)=>{"use strict";r.d(t,{yV:()=>a,zs:()=>s});let a=e=>{try{let t=new URL(e);return`${t.protocol}//${t.host}`}catch{return e}},n={status:["status","status_description"],error:["error","error_description"],success:["success","success_description"]},i=(e,t,r,a="",i="")=>{let[s,o]=n[t],l=e.includes("?"),c=`${e}${l?"&":"?"}${s}=${encodeURIComponent(r)}`;return a&&(c+=`&${o}=${encodeURIComponent(a)}`),i&&(c+=`&${i}`),c},s=(e,t,r="",a="")=>i(e,"success",t,r,a)}};var t=require("../../../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),a=t.X(0,[948,212,49,492,86,935,236,656,235,667,740,869],()=>r(38137));module.exports=a})();