(()=>{var e={};e.id=647,e.ids=[647],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},78893:e=>{"use strict";e.exports=require("buffer")},84770:e=>{"use strict";e.exports=require("crypto")},17702:e=>{"use strict";e.exports=require("events")},32615:e=>{"use strict";e.exports=require("http")},35240:e=>{"use strict";e.exports=require("https")},98216:e=>{"use strict";e.exports=require("net")},68621:e=>{"use strict";e.exports=require("punycode")},76162:e=>{"use strict";e.exports=require("stream")},82452:e=>{"use strict";e.exports=require("tls")},17360:e=>{"use strict";e.exports=require("url")},71568:e=>{"use strict";e.exports=require("zlib")},66752:(e,s,t)=>{"use strict";t.r(s),t.d(s,{GlobalError:()=>i.a,__next_app__:()=>u,originalPathname:()=>p,pages:()=>d,routeModule:()=>h,tree:()=>o}),t(56348),t(50151),t(78243),t(35866);var a=t(23191),r=t(88716),l=t(37922),i=t.n(l),c=t(95231),n={};for(let e in c)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(n[e]=()=>c[e]);t.d(s,n);let o=["",{children:["[locale]",{children:["(insight)",{children:["manage-sites",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,56348)),"/Users/guillaume/Documents/perso/heatpeek-project/heatpeek/src/app/[locale]/(insight)/manage-sites/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(t.bind(t,50151)),"/Users/guillaume/Documents/perso/heatpeek-project/heatpeek/src/app/[locale]/(insight)/layout.tsx"]}]},{layout:[()=>Promise.resolve().then(t.bind(t,78243)),"/Users/guillaume/Documents/perso/heatpeek-project/heatpeek/src/app/[locale]/layout.tsx"]}]},{"not-found":[()=>Promise.resolve().then(t.t.bind(t,35866,23)),"next/dist/client/components/not-found-error"]}],d=["/Users/guillaume/Documents/perso/heatpeek-project/heatpeek/src/app/[locale]/(insight)/manage-sites/page.tsx"],p="/[locale]/(insight)/manage-sites/page",u={require:t,loadChunk:()=>Promise.resolve()},h=new a.AppPageRouteModule({definition:{kind:r.x.APP_PAGE,page:"/[locale]/(insight)/manage-sites/page",pathname:"/[locale]/manage-sites",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:o}})},48509:(e,s,t)=>{let a={"09c447a8bb91d9ea07ebba599164ec6a8e584218":()=>Promise.resolve().then(t.bind(t,29024)).then(e=>e.deleteProjectAction),"21b7b0af99debd6f74cf8406e00c4e550cc0783d":()=>Promise.resolve().then(t.bind(t,29024)).then(e=>e.updateProjectAction),"91113f78f837ea0822313b29fef5b32b6493037f":()=>Promise.resolve().then(t.bind(t,29024)).then(e=>e.addProjectAction),"12d1b960d162fcd9e9feea23a05b842f334f050e":()=>Promise.resolve().then(t.bind(t,5559)).then(e=>e.signOut),"6a8a26413187bace2643ca46c408820ea12e2665":()=>Promise.resolve().then(t.bind(t,5559)).then(e=>e.signUp),dc2a9c5531559720941b8aaec462d0ad3ea2145e:()=>Promise.resolve().then(t.bind(t,5559)).then(e=>e.signIn)};async function r(e,...s){return(await a[e]()).apply(null,s)}e.exports={"09c447a8bb91d9ea07ebba599164ec6a8e584218":r.bind(null,"09c447a8bb91d9ea07ebba599164ec6a8e584218"),"21b7b0af99debd6f74cf8406e00c4e550cc0783d":r.bind(null,"21b7b0af99debd6f74cf8406e00c4e550cc0783d"),"91113f78f837ea0822313b29fef5b32b6493037f":r.bind(null,"91113f78f837ea0822313b29fef5b32b6493037f"),"12d1b960d162fcd9e9feea23a05b842f334f050e":r.bind(null,"12d1b960d162fcd9e9feea23a05b842f334f050e"),"6a8a26413187bace2643ca46c408820ea12e2665":r.bind(null,"6a8a26413187bace2643ca46c408820ea12e2665"),dc2a9c5531559720941b8aaec462d0ad3ea2145e:r.bind(null,"dc2a9c5531559720941b8aaec462d0ad3ea2145e")}},26042:(e,s,t)=>{Promise.resolve().then(t.bind(t,1279)),Promise.resolve().then(t.bind(t,46063))},26754:(e,s,t)=>{"use strict";t.d(s,{Z:()=>a});let a=(0,t(62881).Z)("chart-column",[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]])},1279:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>x});var a=t(10326),r=t(91664),l=t(11733),i=t(44794),c=t(41190),n=t(83855),o=t(77506),d=t(29280),p=t(17577),u=t(83351),h=t(85999),j=t(93935),m=t(71475),b=t(9969);function x(){let[e,s]=(0,p.useState)(!1),[t,x]=(0,p.useState)(null),[g,f]=(0,p.useTransition)(),y=(0,m.QT)();return(0,a.jsxs)(l.Vq,{open:e,onOpenChange:s,children:[a.jsx(l.hg,{asChild:!0,children:(0,a.jsxs)(r.z,{className:"bg-primary hover:bg-primary/90",children:[a.jsx(n.Z,{className:"w-4 h-4 mr-2"}),y("projects.addProject.button")]})}),(0,a.jsxs)(l.cZ,{className:"sm:max-w-[500px]",children:[(0,a.jsxs)(l.fK,{children:[a.jsx(l.$N,{children:y("projects.addProject.title")}),a.jsx(l.Be,{children:y("projects.addProject.description")})]}),(0,a.jsxs)(b.l,{action:e=>{f(async()=>{try{let t=""===e.get("type")?null:e.get("type"),a={label:e.get("label"),type:t,baseUrl:e.get("baseUrl")},r=(0,u.sm)(y).safeParse(a);if(!r.success)throw Error(r.error.errors[0].message);await (0,j.o)(r.data),s(!1),h.Am.success(y("projects.addProject.success"))}catch(e){h.Am.error(e instanceof Error?e.message:y("projects.addProject.error"))}})},isDisabled:g,children:[(0,a.jsxs)("div",{className:"grid gap-4 py-4",children:[(0,a.jsxs)("div",{className:"grid gap-2",children:[a.jsx(i._,{htmlFor:"label",children:y("projects.addProject.labels.projectName")}),a.jsx(c.I,{id:"label",name:"label",placeholder:y("projects.addProject.labels.projectNamePlaceholder")})]}),(0,a.jsxs)("div",{className:"grid gap-2",children:[a.jsx(i._,{htmlFor:"baseUrl",children:y("projects.addProject.labels.baseUrl")}),a.jsx(c.I,{id:"baseUrl",name:"baseUrl",placeholder:y("projects.addProject.labels.baseUrlPlaceholder"),required:!0})]}),(0,a.jsxs)("div",{className:"grid gap-2",children:[a.jsx(i._,{htmlFor:"type",children:y("projects.addProject.labels.category")}),(0,a.jsxs)(d.Ph,{value:t||void 0,onValueChange:e=>x(e),children:[a.jsx(d.i4,{children:a.jsx(d.ki,{placeholder:y("projects.addProject.labels.categoryPlaceholder")})}),a.jsx(d.Bw,{children:Object.values(u.qG).map(e=>a.jsx(d.Ql,{value:e,children:e},e))})]}),a.jsx("input",{type:"hidden",name:"type",value:t||void 0})]})]}),(0,a.jsxs)(l.cN,{children:[a.jsx(r.z,{variant:"outline",type:"button",onClick:()=>s(!1),children:y("projects.addProject.buttons.cancel")}),(0,a.jsxs)(r.z,{type:"submit",disabled:g,children:[g&&a.jsx(o.Z,{className:"w-4 h-4 mr-2 animate-spin"}),y("projects.addProject.buttons.create")]})]})]})]})]})}},46063:(e,s,t)=>{"use strict";t.d(s,{default:()=>A});var a=t(10326),r=t(29752),l=t(38443),i=t(10143),c=t(91664),n=t(9969),o=t(62881);let d=(0,o.Z)("ellipsis",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]]);var p=t(69508),u=t(98091),h=t(54014),j=t(26754);let m=(0,o.Z)("link",[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]]);var b=t(77506),x=t(17577),g=t(11733),f=t(44794),y=t(41190),v=t(29280);let P={SAAS:"SaaS",ECOMMERCE:"E-commerce",BLOG:"Blog",PORTFOLIO:"Portfolio",CORPORATE:"Corporate",OTHER:"other"};var w=t(93935),O=t(85999),N=t(71475),E=t(90434),R=t(83351),C=t(55296);function A({projects:e}){let s=(0,N.QT)(),[t,n]=(0,x.useState)(!1),[o,b]=(0,x.useState)(null),[g,f]=(0,x.useTransition)(),y=e=>{b(e),n(!0)},v=e=>{f(async()=>{try{await (0,w.u3)(e.id),O.Am.success(s("projects.deleteProject.success"))}catch(e){O.Am.error(e instanceof Error?e.message:s("projects.deleteProject.error"))}})};return(0,a.jsxs)("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-3",children:[e.map(e=>(0,a.jsxs)(r.Zb,{className:"hover:shadow-lg transition-shadow flex flex-col justify-between",children:[a.jsx(r.Ol,{className:"pb-3",children:(0,a.jsxs)("div",{className:"flex items-start justify-between",children:[(0,a.jsxs)("div",{className:"flex-1",children:[a.jsx(r.ll,{className:"text-lg",children:e.label}),e.type&&a.jsx(l.C,{variant:"secondary",className:"mt-2",children:e.type})]}),(0,a.jsxs)(C.aR,{children:[(0,a.jsxs)(i.h_,{children:[a.jsx(i.$F,{asChild:!0,children:a.jsx(c.z,{variant:"ghost",size:"icon",children:a.jsx(d,{className:"w-4 h-4"})})}),(0,a.jsxs)(i.AW,{align:"end",children:[(0,a.jsxs)(i.Xi,{onClick:()=>y(e),children:[a.jsx(p.Z,{className:"w-4 h-4 mr-2"}),s("projects.actions.edit")]}),a.jsx(C.vW,{asChild:!0,children:(0,a.jsxs)(i.Xi,{className:"text-red-600",children:[a.jsx(u.Z,{className:"w-4 h-4 mr-2"}),s("projects.actions.delete")]})})]})]}),(0,a.jsxs)(C._T,{onCloseAutoFocus:e=>{e.preventDefault(),document.body.style.pointerEvents=""},children:[(0,a.jsxs)(C.fY,{children:[a.jsx(C.f$,{children:s("projects.deleteProject.confirmTitle")}),a.jsx(C.yT,{children:s("projects.deleteProject.confirmDescription")})]}),(0,a.jsxs)(C.xo,{children:[a.jsx(C.le,{children:s("global.cancel")}),a.jsx(C.OL,{variant:"destructive",onClick:()=>v(e),disabled:g,children:s("global.delete")})]})]})]})]})}),(0,a.jsxs)(r.aY,{className:"space-y-4 pt-auto",children:[a.jsx("div",{children:(0,a.jsxs)("div",{className:"text-sm text-muted-foreground flex items-center gap-1",children:[a.jsx(h.Z,{className:"w-3 h-3"}),e.base_url]})}),(0,a.jsxs)("div",{className:"flex gap-2",children:[a.jsx(E.default,{href:`/${e.id}/get-started`,children:(0,a.jsxs)(c.z,{size:"sm",className:"flex-1",children:[a.jsx(j.Z,{className:"w-4 h-4 mr-1"}),s("projects.buttons.viewAnalytics")]})}),a.jsx(E.default,{href:`/${e.id}/manage-urls`,children:(0,a.jsxs)(c.z,{variant:"outline",size:"sm",className:"flex-1",children:[a.jsx(m,{className:"w-4 h-4 mr-1"}),s("projects.buttons.manageUrls")]})})]})]})]},e.id)),o&&a.jsx(U,{editingProject:o,isEditDialogOpen:t,setIsEditDialogOpen:n})]})}let U=({editingProject:e,isEditDialogOpen:s,setIsEditDialogOpen:t})=>{let r=(0,N.QT)(),[l,i]=(0,x.useTransition)(),[o,d]=(0,x.useState)(e.type);return(0,x.useEffect)(()=>{d(e.type)},[e.type]),a.jsx(g.Vq,{open:s,onOpenChange:t,children:a.jsx(g.cZ,{className:"sm:max-w-[500px]",onCloseAutoFocus:e=>{e.preventDefault(),document.body.style.pointerEvents=""},children:(0,a.jsxs)(n.l,{action:s=>{i(async()=>{try{let a=""===s.get("type")?null:s.get("type"),l={label:""===s.get("label")?null:s.get("label"),type:a,baseUrl:s.get("baseUrl")},i=(0,R.b)(r).safeParse(l);if(!i.success)throw Error(i.error.errors[0].message);if(!(i.data.label!==e.label||i.data.type!==e.type||i.data.baseUrl!==e.base_url)){t(!1);return}await (0,w.nt)(e.id,i.data),t(!1),O.Am.success(r("projects.editDialog.success"))}catch(e){O.Am.error(e instanceof Error?e.message:r("projects.editDialog.error"))}})},isDisabled:l,children:[(0,a.jsxs)(g.fK,{children:[a.jsx(g.$N,{children:r("projects.editDialog.title")}),a.jsx(g.Be,{children:r("projects.editDialog.description")})]}),e&&(0,a.jsxs)("div",{className:"grid gap-4 py-4",children:[(0,a.jsxs)("div",{className:"grid gap-2",children:[a.jsx(f._,{htmlFor:"label",children:r("projects.editDialog.labels.projectName")}),a.jsx(y.I,{id:"label",name:"label",defaultValue:e.label||void 0})]}),(0,a.jsxs)("div",{className:"grid gap-2",children:[a.jsx(f._,{htmlFor:"baseUrl",children:r("projects.editDialog.labels.baseUrl")}),a.jsx(y.I,{id:"baseUrl",name:"baseUrl",defaultValue:e.base_url,required:!0})]}),(0,a.jsxs)("div",{className:"grid gap-2",children:[a.jsx(f._,{htmlFor:"type",children:r("projects.editDialog.labels.category")}),(0,a.jsxs)(v.Ph,{value:o||void 0,onValueChange:e=>d(e),name:"type",children:[a.jsx(v.i4,{children:a.jsx(v.ki,{placeholder:"Select category"})}),a.jsx(v.Bw,{children:Object.values(P).map(e=>a.jsx(v.Ql,{value:e,children:e},e))})]}),a.jsx("input",{type:"hidden",name:"type",value:o||void 0})]})]}),(0,a.jsxs)(g.cN,{children:[a.jsx(c.z,{variant:"outline",type:"button",onClick:()=>t(!1),children:r("projects.editDialog.buttons.cancel")}),(0,a.jsxs)(c.z,{type:"submit",disabled:l,children:[l&&a.jsx(b.Z,{className:"w-4 h-4 mr-2 animate-spin"}),r("projects.editDialog.buttons.saveChanges")]})]})]})})})}},93935:(e,s,t)=>{"use strict";t.d(s,{nt:()=>r,o:()=>l,u3:()=>i}),t(15424);var a=t(46242),r=(0,a.$)("21b7b0af99debd6f74cf8406e00c4e550cc0783d"),l=(0,a.$)("91113f78f837ea0822313b29fef5b32b6493037f"),i=(0,a.$)("09c447a8bb91d9ea07ebba599164ec6a8e584218")},83351:(e,s,t)=>{"use strict";t.d(s,{b:()=>c,qG:()=>l,sm:()=>i});var a=t(51223),r=t(79512);let l={SAAS:"SaaS",ECOMMERCE:"E-commerce",BLOG:"Blog",PORTFOLIO:"Portfolio",CORPORATE:"Corporate",OTHER:"Other"},i=e=>r.ZP.object({label:r.ZP.string().max(40,e("projects.validation.labelTooLong")).optional(),type:r.ZP.enum([l.SAAS,l.ECOMMERCE,l.BLOG,l.PORTFOLIO,l.CORPORATE,l.OTHER]).nullable().optional(),baseUrl:r.ZP.string().min(1,e("projects.validation.baseUrlRequired")).url(e("projects.validation.invalidUrl")).transform(e=>(0,a.yV)(e))}),c=e=>i(e)},29024:(e,s,t)=>{"use strict";let a,r;t.r(s),t.d(s,{addProjectAction:()=>x,deleteProjectAction:()=>g,updateProjectAction:()=>f});var l=t(27745);t(26461);var i=t(30207),c=t(71870),n=t(15583),o=t(43811),d=t(44573);let p={SAAS:"SaaS",ECOMMERCE:"E-commerce",BLOG:"Blog",PORTFOLIO:"Portfolio",CORPORATE:"Corporate",OTHER:"Other"},u=e=>d.ZP.object({label:d.ZP.string().max(40,e("projects.validation.labelTooLong")).optional(),type:d.ZP.enum([p.SAAS,p.ECOMMERCE,p.BLOG,p.PORTFOLIO,p.CORPORATE,p.OTHER]).nullable().optional(),baseUrl:d.ZP.string().min(1,e("projects.validation.baseUrlRequired")).url(e("projects.validation.invalidUrl")).transform(e=>(0,o.yV)(e))}),h=e=>u(e);var j=t(74739),m=t(42405);let b=require("node:crypto");async function x(e){let s=await (0,m.nI)(),t=await (0,c.e)(),{user:l}=await (0,n.PR)(t);l||(0,j.redirect)("/signin");let o=u(s).safeParse(e);if(!o.success)throw Error(o.error.errors[0].message);let d=e.label||new URL(e.baseUrl).hostname,p=function(e=21){var s;s=e|=0,!a||a.length<s?(a=Buffer.allocUnsafe(128*s),b.webcrypto.getRandomValues(a),r=0):r+s>a.length&&(b.webcrypto.getRandomValues(a),r=0),r+=s;let t="";for(let s=r-e;s<r;s++)t+="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict"[63&a[s]];return t}(8),h=await (0,n.B)(t,{label:d,base_url:e.baseUrl,tracking_id:p,type:e.type});try{await (0,n.Xv)(t,{tracking_id:p,project_id:h})}catch(e){throw await (0,n.th)(t,h),console.error("Failed to add project config. Rolled back project creation.",e),Error("Failed to add project config.")}(0,i.revalidatePath)(`/${h}/manage-urls`,"layout"),(0,j.redirect)(`/${h}/manage-urls`)}async function g(e){let s=await (0,c.e)();await (0,n.th)(s,e),(0,i.revalidatePath)("/manage-sites","layout")}async function f(e,s){let t=await (0,m.nI)(),a=await (0,c.e)(),r=h(t).safeParse(s);if(!r.success)throw Error(r.error.errors[0].message);await (0,n.ty)(a,e,{label:r.data.label||null,type:r.data.type||void 0,base_url:r.data.baseUrl}),(0,i.revalidatePath)("/[locale]/(insight)/manage-sites","page")}(0,t(85723).h)([x,g,f]),(0,l.j)("91113f78f837ea0822313b29fef5b32b6493037f",x),(0,l.j)("09c447a8bb91d9ea07ebba599164ec6a8e584218",g),(0,l.j)("21b7b0af99debd6f74cf8406e00c4e550cc0783d",f)},56348:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>u});var a=t(19510),r=t(65655),l=t(538),i=t(58585),c=t(60209),n=t(68570);let o=(0,n.createProxy)(String.raw`/Users/guillaume/Documents/perso/heatpeek-project/heatpeek/src/app/[locale]/(insight)/manage-sites/AddProject.tsx#default`);async function d(){let e=await (0,c.nI)();return a.jsx("div",{className:"mb-6",children:(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,a.jsxs)("div",{children:[a.jsx("h1",{className:"text-2xl font-bold",children:e("projects.title")}),a.jsx("p",{className:"text-muted-foreground",children:e("projects.description")})]}),a.jsx("div",{className:"flex items-center gap-2",children:a.jsx(o,{})})]})})}let p=(0,n.createProxy)(String.raw`/Users/guillaume/Documents/perso/heatpeek-project/heatpeek/src/app/[locale]/(insight)/manage-sites/ProjectsList.tsx#default`);async function u(){let e=await (0,r.e)(),{user:s}=await (0,l.PR)(e);s||(0,i.redirect)("/signin");let t=await (0,c.nI)(),n=await (0,l.mW)(e,s.id);return(0,a.jsxs)("div",{className:"h-full",children:[a.jsx(d,{}),n&&n.length>0?a.jsx(p,{projects:n}):(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center h-full gap-4 mt-[15%]",children:[a.jsx("p",{className:"text-muted-foreground",children:t("projects.emptyState")}),a.jsx(o,{})]})]})}},43811:(e,s,t)=>{"use strict";t.d(s,{yV:()=>a,zs:()=>i});let a=e=>{try{let s=new URL(e);return`${s.protocol}//${s.host}`}catch{return e}},r={status:["status","status_description"],error:["error","error_description"],success:["success","success_description"]},l=(e,s,t,a="",l="")=>{let[i,c]=r[s],n=e.includes("?"),o=`${e}${n?"&":"?"}${i}=${encodeURIComponent(t)}`;return a&&(o+=`&${c}=${encodeURIComponent(a)}`),l&&(o+=`&${l}`),o},i=(e,s,t="",a="")=>l(e,"success",s,t,a)}};var s=require("../../../../webpack-runtime.js");s.C(e);var t=e=>s(s.s=e),a=s.X(0,[948,212,49,492,935,236,112,656,667,740,873],()=>t(66752));module.exports=a})();