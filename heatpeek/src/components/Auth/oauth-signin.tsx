"use client";

import { signInWithOAuth } from "@/lib/auth-helpers/client";
import { type Provider } from "@supabase/supabase-js";
import { JSX, useTransition } from "react";
import { Button } from "../ui/button";

type OAuthProviders = {
  name: Provider;
  displayName: string;
  icon: JSX.Element;
};

export default function OauthSignIn() {
  const [isPending, startTransition] = useTransition();

  const oAuthProviders: OAuthProviders[] = [
    {
      name: "google",
      displayName: "Google",
      icon: <Google className="h-5 w-5" />,
    },
  ];

  const handleSubmit = async (e: React.FormEvent<HTMLFormElement>) => {
    startTransition(async () => {
      await signInWithOAuth(e);
    });
  };

  return (
    <>
      <p className="text-sm opacity-30 mt-2">Third-party sign in</p>
      <div className="mt-4 w-full flex gap-1">
        {oAuthProviders.map((provider) => (
          <form
            key={provider.name}
            className="pb-2 w-full"
            onSubmit={(e) => handleSubmit(e)}
          >
            <input type="hidden" name="provider" value={provider.name} />
            <Button
              type="submit"
              className="w-full bg-foreground"
              disabled={isPending}
            >
              <span className="mr-2">{provider.icon}</span>
              <span>{provider.displayName}</span>
            </Button>
          </form>
        ))}
      </div>
    </>
  );
}

const Google = ({ className }: { className: string }) => {
  return (
    <svg
      width="56"
      height="58"
      viewBox="0 0 56 58"
      fill="none"
      xmlns="http://www.w3.org/2000/svg"
      className={className}
    >
      <g clipPath="url(#clip0_1691_2)">
        <path
          d="M19.2342 1.908C13.4584 3.91837 8.47743 7.73413 5.0228 12.7948C1.56818 17.8554 -0.17797 23.8943 0.040841 30.0242C0.259652 36.1542 2.43189 42.0522 6.23848 46.852C10.0451 51.6517 15.2854 55.1002 21.1897 56.6908C25.9764 57.9301 30.9915 57.9845 35.8039 56.8494C40.1634 55.8669 44.1939 53.7653 47.5007 50.7503C50.9423 47.5166 53.4404 43.4028 54.7265 38.8513C56.1243 33.9017 56.373 28.6964 55.4536 23.6353H28.5736V34.823H44.1407C43.8295 36.6073 43.1628 38.3104 42.1804 39.8302C41.198 41.35 39.9201 42.6553 38.4232 43.668C36.5223 44.9296 34.3795 45.7785 32.1323 46.1602C29.8785 46.5807 27.5667 46.5807 25.3129 46.1602C23.0286 45.6863 20.8677 44.7404 18.9677 43.3825C15.9155 41.2147 13.6237 38.135 12.4194 34.5828C11.1947 30.9642 11.1947 27.0411 12.4194 23.4224C13.2766 20.8859 14.6938 18.5764 16.5652 16.6663C18.7067 14.4403 21.4179 12.8491 24.4014 12.0674C27.3848 11.2857 30.5252 11.3436 33.4781 12.2347C35.7848 12.9452 37.8942 14.1865 39.6381 15.8597C41.3933 14.1076 43.1456 12.351 44.8948 10.5899C45.7981 9.64284 46.7826 8.74112 47.6723 7.77144C45.0103 5.28594 41.8857 3.35191 38.4774 2.08019C32.2709 -0.180954 25.4799 -0.24172 19.2342 1.908Z"
          fill="white"
        />
        <path
          d="M19.2342 1.90727C25.4794 -0.243908 32.2704 -0.184742 38.4774 2.07493C41.8863 3.35529 45.0095 5.29863 47.6678 7.79337C46.7645 8.76305 45.8116 9.6693 44.8903 10.6118C43.1381 12.3669 41.3873 14.116 39.6381 15.859C37.8942 14.1858 35.7848 12.9445 33.4781 12.234C30.5262 11.3397 27.3859 11.2785 24.4016 12.057C21.4174 12.8355 18.7045 14.4238 16.5607 16.6474C14.6893 18.5575 13.2721 20.867 12.4149 23.4035L3.05292 16.1309C6.40392 9.46341 12.206 4.36332 19.2342 1.90727Z"
          fill="#E33629"
        />
        <path
          d="M0.56902 23.3355C1.07221 20.8334 1.90762 18.4102 3.05289 16.1309L12.4148 23.4216C11.1901 27.0403 11.1901 30.9634 12.4148 34.5821C9.29569 36.9988 6.17504 39.4275 3.05289 41.8684C0.18583 36.1423 -0.688574 29.6181 0.56902 23.3355Z"
          fill="#F8BD00"
        />
        <path
          d="M28.5735 23.6309H55.4535C56.373 28.692 56.1243 33.8972 54.7264 38.8468C53.4404 43.3983 50.9423 47.5121 47.5006 50.7459C44.4793 48.3805 41.4445 46.0334 38.4232 43.668C39.9211 42.6543 41.1996 41.3476 42.182 39.8261C43.1645 38.3047 43.8307 36.5999 44.1406 34.814H28.5735C28.569 31.0893 28.5735 27.3601 28.5735 23.6309Z"
          fill="#587DBD"
        />
        <path
          d="M3.0484 41.8683C6.17055 39.4516 9.2912 37.0229 12.4103 34.582C13.6171 38.1354 15.9122 41.2153 18.9678 43.3817C20.8736 44.7332 23.0392 45.6715 25.3265 46.1367C27.5803 46.5572 29.892 46.5572 32.1458 46.1367C34.393 45.7551 36.5359 44.9062 38.4368 43.6445C41.4581 46.0098 44.4929 48.357 47.5142 50.7223C44.2079 53.7389 40.1774 55.8421 35.8174 56.8259C31.0051 57.961 25.99 57.9066 21.2032 56.6673C17.4174 55.6531 13.8811 53.8652 10.8161 51.4156C7.57203 48.8314 4.92239 45.5747 3.0484 41.8683Z"
          fill="#319F43"
        />
      </g>
      <defs>
        <clipPath id="clip0_1691_2">
          <rect width="56" height="58" fill="white" />
        </clipPath>
      </defs>
    </svg>
  );
};
